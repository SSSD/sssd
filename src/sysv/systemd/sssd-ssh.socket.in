[Unit]
Description=SSSD SSH Service responder socket
Documentation=man:sssd.conf(5)
After=sssd.service
BindsTo=sssd.service
DefaultDependencies=no
Conflicts=shutdown.target

[Socket]
ExecStartPre=/bin/sh -c "! (pidof -q sssd_ssh && pidof sssd_ssh | xargs ps -o mntns -p | grep -q `lsns -n -t mnt -o NS -p \\$\\$`)"
ListenStream=@pipepath@/ssh
SocketUser=@SSSD_USER@
SocketGroup=@SSSD_USER@

[Install]
WantedBy=sssd.service
